#!/bin/bash

kubectl create namespace exploitable

####################################################
#Remove Old Charts
####################################################
helm del --purge exploitable-ingress;
helm del --purge db;
helm del --purge redis;
helm del --purge exploitableapp-ws;
helm del --purge exploitableapp;

####################################################
#Add Charts
####################################################
helm install stable/nginx-ingress --namespace exploitable --name exploitable-ingress --set rbac.create=true
helm install --namespace exploitable --name db ./charts/db/
helm install --namespace exploitable --name redis ./charts/redis/
helm install --namespace exploitable --name exploitableapp-ws ./charts/exploitableappwebservice/
helm install --namespace exploitable --name exploitableapp ./charts/exploitableapp/

####################################################
#Watch Pods
####################################################
watch kubectl get all --namespace exploitable

####################################################
#Remove Charts
####################################################
helm del --purge exploitable-ingress;
helm del --purge db;
helm del --purge redis;
helm del --purge exploitableapp-ws;
helm del --purge exploitableapp;

