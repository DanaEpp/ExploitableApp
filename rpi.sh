#!/bin/bash
set -e
sudo apt-get update
sudo apt-get upgrade
sudo apt-get install git
curl -sSL https://get.docker.com | sh
git clone https://github.com/docker/compose.git
cd compose/
git checkout release
sudo docker build -t docker-compose:armhf -f Dockerfile.armhf .
sudo docker run --rm --entrypoint="script/build/linux-entrypoint" -v $(pwd)/dist:/code/dist -v $(pwd)/.git:/code/.git "docker-compose:armhf"
sudo cp dist/docker-compose-Linux-armv7l /usr/local/bin/docker-compose
sudo chown root:root /usr/local/bin/docker-compose
sudo chmod 0755 /usr/local/bin/docker-compose
cd ..
rm -rf compose/
sudo apt-get install curl libunwind8 gettext
curl -sSL -o dotnet.tar.gz https://dotnetcli.blob.core.windows.net/dotnet/Runtime/release/2.0.0/dotnet-runtime-latest-linux-arm.tar.gz
sudo mkdir -p /opt/dotnet && sudo tar zxf dotnet.tar.gz -C /opt/dotnet
sudo ln -s /opt/dotnet/dotnet /usr/local/bin
rm dotnet.tar.gz 
curl -sSL -o docker-compose.yml https://raw.githubusercontent.com/postworthy/ExploitableApp/master/rpi-docker-compose.yml
