FROM alpine:latest

ENV ROOT_PASSWORD Password1

RUN apk update  && apk upgrade && apk add openssh \
        && sed -i s/#PermitRootLogin.*/PermitRootLogin\ yes/ /etc/ssh/sshd_config \
        && echo "root:${ROOT_PASSWORD}" | chpasswd \
        && echo "#!/bin/sh" >> /entrypoint.sh \
        && echo "exec /usr/sbin/sshd -D -e" >> /entrypoint.sh \
        && chmod a+x /entrypoint.sh \
        && rm -rf /var/cache/apk/* /tmp/* \
        && ssh-keygen -A

EXPOSE 22

ENTRYPOINT ["/entrypoint.sh"]