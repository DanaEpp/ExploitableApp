@{
    ViewData["Title"] = "Home Page";
    var backgrounds = new[] { "bhm-bg.jpg", "bhm-bg2.jpg", "atl-bg.jpg", "atl-bg2.jpg", };
    var bg = backgrounds[0];
    var r = new Random();
    var rnd = r.NextDouble();
    if (rnd >= .25 && rnd < .50)
    {
        bg = backgrounds[1];
    }
    else if (rnd >= .5 && rnd < .75)
    {
        bg = backgrounds[2];
    }
    else if (rnd >= .75)
    {
        bg = backgrounds[3];
    }
    else
    {
        bg = backgrounds[0];
    }

    var loginActionURL = $"{Context.Request.Scheme}://{Context.Request.Host}/account/login?returnurl={Context.Request.Scheme}://{Context.Request.Host}/account/tokenlogin";

    var isWebServerSafe = Environment.GetEnvironmentVariable("flag-exploitableapp") != Environment.GetEnvironmentVariable("Flag");
    var isTransactionServerSafe = Environment.GetEnvironmentVariable("flag-exploitableapp-ws") != Environment.GetEnvironmentVariable("Flag");
    var isDatabaseServerSafe = Environment.GetEnvironmentVariable("flag-db") != Environment.GetEnvironmentVariable("Flag");
    var isRedisServerSafe = Environment.GetEnvironmentVariable("flag-redis") != Environment.GetEnvironmentVariable("Flag");
}
<style>
    body {
        background-image: url('../images/@bg');
        background-repeat: no-repeat;
        background-position: center;
        background-position-y: bottom;
        background-size: cover;
    }

    .panel{
        border-radius: 6px;
    }

    .panel-heading{
        border-top-right-radius: 6px;
        border-top-left-radius: 6px;
    }

    .navbar-default {
        background-color: rgba(34,34,34,.7);
    }
</style>
<br />
<div class="row">
    <div class=" col-md-5">
        <div class="panel panel-default">
            <div class="panel-heading"><h4>Log In</h4></div>
            <form method="post" action="@loginActionURL" asp-antiforgery="true" class="panel-body">
                <div class="form-group">
                    <label>Email</label>
                    <input name="Email" class="form-control" />
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" name="Password" class="form-control" />
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-default">Log in</button>
                </div>
                <div class="form-group">
                    <p>
                        <a asp-controller="account" asp-action="ForgotPassword">Forgot your password?</a>
                    </p>
                    <p>
                        <a asp-controller="account" asp-action="Register" asp-route-returnurl="@ViewData[" ReturnUrl"]">Register as a new user?</a>
                    </p>
                </div>
            </form>
        </div>
    </div>
    <div class=col-md-7>
        <div class="panel panel-default">
            <div class="panel-heading"><h4>Welcome!</h4></div>
            <div class="panel-body">
                <p>
                    <big>
                        Welcome to the <a href="http://exploitable.app">Exploitable App</a>. This application has been created as a sandbox for web application penetration testing. Hidden within this application are numerous flaws which should allow you the opportunity to test your skills as a hacker or fine-tune your craft as a security professional.
                    </big>
                </p>
                <p>
                    <big>
                        I would suggest having a look at the <a href="https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project" id="owasp">OWASP Top 10 Project</a> as you are sure to find a few of those vulnerabilities here.
                    </big>
                </p>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading"><h4>Flags!</h4></div>
            <div class="panel-body">
                <p>
                    <big>
                        Plant your flag! Place this text <strong>@Environment.GetEnvironmentVariable("Flag")</strong> in <strong>/root/.flag</strong> on each server to let the system know you have control of the root account.
                    </big>
                </p>
                <div class="row">
                    <div class="col-sm-3">
                        <div class="panel panel-default exploitableapp">
                            <div class="panel-heading text-center"><h4>Web</h4></div>
                            <div class="panel-body text-center safe @(isWebServerSafe ? "" : "hidden")" style="color:#228B22;">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-flag fa-stack-2x"></i>
                                </span>
                                <br />
                                <big><strong>SAFE!</strong></big>
                            </div>
                            <div class="panel-body text-center pwnd @(!isWebServerSafe ? "" : "hidden")" style="color:#8B0000;">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-flag fa-stack-2x"></i>
                                </span>
                                <br />
                                <big><strong>PWND!</strong></big>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-3">
                        <div class="panel panel-default db">
                            <div class="panel-heading text-center"><h4>Database</h4></div>
                            <div class="panel-body text-center safe @(isDatabaseServerSafe ? "" : "hidden")" style="color:#228B22;">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-flag fa-stack-2x"></i>
                                </span>
                                <br />
                                <big><strong>SAFE!</strong></big>
                            </div>
                            <div class="panel-body text-center pwnd @(!isDatabaseServerSafe ? "" : "hidden")" style="color:#8B0000;">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-flag fa-stack-2x"></i>
                                </span>
                                <br />
                                <big><strong>PWND!</strong></big>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-3">
                        <div class="panel panel-default exploitableapp-ws">
                            <div class="panel-heading text-center"><h4>Transaction</h4></div>
                            <div class="panel-body text-center safe @(isTransactionServerSafe ? "" : "hidden")" style="color:#228B22;">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-flag fa-stack-2x"></i>
                                </span>
                                <br />
                                <big><strong>SAFE!</strong></big>
                            </div>
                            <div class="panel-body text-center pwnd @(!isTransactionServerSafe ? "" : "hidden")" style="color:#8B0000;">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-flag fa-stack-2x"></i>
                                </span>
                                <br />
                                <big><strong>PWND!</strong></big>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-3">
                        <div class="panel panel-default redis">
                            <div class="panel-heading text-center"><h4>Redis</h4></div>
                            <div class="panel-body text-center safe @(isRedisServerSafe ? "" : "hidden")" style="color:#228B22;">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-flag fa-stack-2x"></i>
                                </span>
                                <br />
                                <big><strong>SAFE!</strong></big>
                            </div>
                            <div class="panel-body text-center pwnd @(!isRedisServerSafe ? "" : "hidden")" style="color:#8B0000;">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-flag fa-stack-2x"></i>
                                </span>
                                <br />
                                <big><strong>PWND!</strong></big>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- No longer used
    <div class=col-md-6>
        <div id="myCarousel" class="carousel slide" data-ride="carousel" data-interval="6000" style="border-radius:10px;overflow:hidden;box-shadow: 2px 2px 10px 2px">
            <ol class="carousel-indicators">
                <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                <li data-target="#myCarousel" data-slide-to="1"></li>
                <li data-target="#myCarousel" data-slide-to="2"></li>
                <li data-target="#myCarousel" data-slide-to="3"></li>
            </ol>
            <div class="carousel-inner" role="listbox">
                <div class="item active">
                    <img src="" alt="Image 1" class="img-responsive" id="b1" />
                    <div class="carousel-caption" role="option">
                        <p>
                            Save for every season of life!
                        </p>
                    </div>
                </div>
                <div class="item">
                    <img src="" alt="Image 2" class="img-responsive" id="b2" />
                    <div class="carousel-caption" role="option">
                        <p>
                            Watch you savings grow, sign up today!
                        </p>
                    </div>
                </div>
                <div class="item">
                    <img src="" alt="Image 3" class="img-responsive" id="b3" />
                    <div class="carousel-caption" role="option">
                        <p>
                            Your money, your way, take advantage of our services to maximize your earnings!
                        </p>
                    </div>
                </div>
                <div class="item">
                    <img src="" alt="Image 4" class="img-responsive" id="b4" />
                    <div class="carousel-caption" role="option">
                        <p>
                            Diversify your earning potential with alternative currencies!
                        </p>
                    </div>
                </div>
            </div>
            <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
                <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
                <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
    </div>
        -->
</div>
@section scripts{
    <!--
    <script src="~/js/carousel.js"></script>
    <script>
        $(document).ready(function(){
            Carousel = new Carousel('@Url.Content("~/")');
            Carousel.Init();
        });
    </script>
    -->

    <script src="~/lib/signalr/signalr.js"></script>
    <script src="~/lib/bootstrap-notify/bootstrap-notify.js"></script>
    <script>
        var flag = '@Environment.GetEnvironmentVariable("Flag")';
        var connection = null;
        $(document).ready(function () {

            connection = new signalR.HubConnectionBuilder().withUrl("/pwnhub").build();

            connection.on("ReceivePwnNotification", function (pwnNotification) {
                if (console) console.log(pwnNotification);

                if (pwnNotification.info == flag) {
                    $("." + pwnNotification.server + " .safe").addClass("hidden");
                    $("." + pwnNotification.server + " .pwnd").removeClass("hidden");
                }

            });

            connection.start();

        });
    </script>
}
